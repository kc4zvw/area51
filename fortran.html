<!DOCTYPE html>

<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="generator" content="Intelligence,and the sweat of our browser">
  <meta name="Description" content="programming examples for FORTRAN">

  <link rel="stylesheet" type="text/css" href="css/styles.css">

  <title>The FORTRAN examples</title>

</head>

<body>
  <a href="/">HOME</a><br>

  <br>
  <h1 class="www_title">The FORTRAN-90/95 Project</h1>

  <p>Add something here ...</a>

  <pre>

~kc4zvw:

  </pre>

  <h2 class="www_sectiontitle">Notes</h2>

  <p>Add something here ...</p>

  <h2 class="www_sectiontitle">Parallel sieve of Erathostenes</h2>

  <p>Add something here ...</p>

  <pre>

# EOF #
  </pre>

  <h2 class="www_sectiontitle">Header 3</h2>

  <p>Add something here ...</p>

  <h2 class="www_sectiontitle">The 'heapsort' sorting algorithm</h2>

  <p>Add something here ...</p>

<pre>

kc4zvw@www:~$ ./heapsort4
 A program to heapsort an array of real numbers

 Unsorted array:
     0.135926     0.357047     0.830519     0.809682     0.447455
     0.822255     0.999484     0.599683     0.491596     0.743014
     0.356010     0.746209     0.713839     0.548384     0.957996
     0.364840     0.628396     0.441209     0.013950     0.131781
     0.147675     0.817267     0.197695     0.890954     0.885719
     0.647247     0.711633     0.326273     0.838796     0.895829

 Sorted array:
     0.013950     0.131781     0.135926     0.147675     0.197695
     0.326273     0.356010     0.357047     0.364840     0.441209
     0.447455     0.491596     0.548384     0.599683     0.628396
     0.647247     0.711633     0.713839     0.743014     0.746209
     0.809682     0.817267     0.822255     0.830519     0.838796
     0.885719     0.890954     0.895829     0.957996     0.999484

 Finished.
kc4zvw@www:~$

</pre>


<pre>
!
!  An example of the heapsort algorithm in FORTRAN-90
!
!
! $Id:$

program Heapsort_Demo

    implicit none

    integer, parameter :: num = 30
    real :: array(num)

    call random_seed
    call random_number(array)

    write(*,*) "A program to heapsort an array of real numbers"
    write(*,*)
    write(*,*) "Unsorted array: "
    call display_numbers(array)

    call heapsort(array)

    write(*,*) "Sorted array: "
    call display_numbers(array)

    write(*,*) "Finished."

contains

subroutine heapsort(a)

    real, intent(in out) :: a(0:)
    integer :: start, n, bottom
    real :: temp

    n = size(a)
    do start = (n - 2) / 2, 0, -1
        call siftdown(a, start, n);
    end do
   
    do bottom = n - 1, 1, -1
        temp = a(0)
        a(0) = a(bottom)
        a(bottom) = temp;
        call siftdown(a, 0, bottom)
    end do

end subroutine heapsort

subroutine siftdown(a, start, bottom)
  
    real, intent(in out) :: a(0:)
    integer, intent(in) :: start, bottom
    integer :: child, root
    real :: temp

    root = start
    do while (root * 2 + 1 < bottom)
        child = root * 2 + 1

        if (child + 1 < bottom) then
            if (a(child) < a(child+1)) child = child + 1
        end if
    
        if (a(root) < a(child)) then
            temp = a(child)
            a(child) = a(root)
            a(root) = temp
            root = child
        else
            return
        end if  
    end do      
    
end subroutine siftdown

subroutine display_numbers(a)

    real, intent(in out) :: a(0:)
    integer :: start, n
    
    n = size(a)
    do start = 0, n - 1, 1
        write(*, 100, advance='no') a(start)
        if (mod(start, 5) == 4) write(*,*)
    end do
    write(*,*)

100 format (' ', F12.6)

end subroutine display_numbers


end program Heapsort_Demo

! ***** End of File *****
</pre>

  <h2 class="www_sectiontitle">Miscellaneous</h2>

  <p>Add something here ...</p>

  <br />
  <br />
  <footer></footer>
  <br />

  <hr>
  <span class="www_footer">Revised: Friday, March 10, 2023 at 09:01:52 AM (EST)</span>
</body>
</html>
